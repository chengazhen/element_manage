(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ae6add56"],{"05ff":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"添加规格",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"规格","label-width":e.formLabelWidth,prop:"specs",rules:[{required:!0,message:"请输入规格",trigger:"blur"}]}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.specs,callback:function(t){e.$set(e.form,"specs",t)},expression:"form.specs"}})],1),a("el-form-item",{attrs:{label:"包装费","label-width":e.formLabelWidth}},[a("el-input-number",{attrs:{min:1,max:10,label:"包装费"},model:{value:e.form.packing_fee,callback:function(t){e.$set(e.form,"packing_fee",t)},expression:"form.packing_fee"}})],1),a("el-form-item",{attrs:{label:"价格","label-width":e.formLabelWidth}},[a("el-input-number",{attrs:{min:1,max:10,label:"价格"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.moreEnter()}}},[e._v("确 定")])],1)],1),a("div",[a("h3",[e._v("添加商品")]),a("p",[e._v(e._s(e.$route.query.id))]),a("el-row",[a("el-col",{attrs:{span:14,offset:4}},[a("el-card",[a("el-form",{staticClass:"demo-sort",attrs:{model:e.sortData,ret:"sortData","label-width":"120px"}},[a("el-form-item",{attrs:{prop:"sort",label:"食品种类名称"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.handle},model:{value:e.sortData.sort,callback:function(t){e.$set(e.sortData,"sort",t)},expression:"sortData.sort"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-collapse",[a("el-collapse-item",{attrs:{title:"点击添加食品种类"}},[a("el-form",{ref:"addform",attrs:{model:e.addform,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"食品种类",prop:"name",rules:[{required:!0,message:"请输入要添加的食品种类",trigger:"blur"}]}},[a("el-input",{model:{value:e.addform.name,callback:function(t){e.$set(e.addform,"name",t)},expression:"addform.name"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{model:{value:e.addform.description,callback:function(t){e.$set(e.addform,"description",t)},expression:"addform.description"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmitAdd("addform")}}},[e._v("添加")])],1)],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:14}},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{model:e.dynamicValidateForm,"label-width":"120px"}},[a("el-form-item",{attrs:{prop:"name",label:"食品名称",rules:[{required:!0,message:"请输入食品名称",trigger:"blur"}]}},[a("el-input",{model:{value:e.dynamicValidateForm.name,callback:function(t){e.$set(e.dynamicValidateForm,"name",t)},expression:"dynamicValidateForm.name"}})],1),a("el-form-item",{attrs:{label:"食品活动"}},[a("el-input",{model:{value:e.dynamicValidateForm.active,callback:function(t){e.$set(e.dynamicValidateForm,"active",t)},expression:"dynamicValidateForm.active"}})],1),a("el-form-item",{attrs:{label:"食品详情"}},[a("el-input",{model:{value:e.dynamicValidateForm.description,callback:function(t){e.$set(e.dynamicValidateForm,"description",t)},expression:"dynamicValidateForm.description"}})],1),a("el-form-item",{attrs:{label:"上传图片",prop:"image_path",rules:[{required:!0,message:"请上传图片",trigger:"change"}]}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://elm.cangdu.org/v1/addimg/food","show-file-list":!1,"on-success":e.handleAvatarSuccess}},[e.dynamicValidateForm.image_path?a("img",{staticClass:"avatar",attrs:{src:e.imgBaseUrl+e.dynamicValidateForm.image_path}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"食品特点"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.dynamicValidateForm.attributes,callback:function(t){e.$set(e.dynamicValidateForm,"attributes",t)},expression:"dynamicValidateForm.attributes"}},e._l(e.attrOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"食品规格"}},[a("el-radio",{attrs:{label:"单规格"},on:{change:e.single},model:{value:e.specsRadio,callback:function(t){e.specsRadio=t},expression:"specsRadio"}}),a("el-radio",{attrs:{label:"多规格"},on:{change:e.more},model:{value:e.specsRadio,callback:function(t){e.specsRadio=t},expression:"specsRadio"}})],1),e.isSingle?a("div",[a("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加规格")]),a("el-form-item",{staticClass:"moreForm_box",attrs:{label:""}},[a("el-table",{attrs:{data:e.dynamicValidateForm.specs}},[a("el-table-column",{attrs:{prop:"specs",label:"规格"}}),a("el-table-column",{attrs:{prop:"packing_fee",label:"包装费"}}),a("el-table-column",{attrs:{prop:"price",label:"价格"}}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,3778300450)})],1)],1)],1):a("div",[a("el-form-item",{attrs:{label:"包装费"}},[a("el-input-number",{attrs:{min:1,max:10,label:"包装费"},on:{change:e.handleChangePacking_fee},model:{value:e.dynamicValidateForm.specs[0].packing_fee,callback:function(t){e.$set(e.dynamicValidateForm.specs[0],"packing_fee",t)},expression:"dynamicValidateForm.specs[0].packing_fee"}})],1),a("el-form-item",{attrs:{label:"价格"}},[a("el-input-number",{attrs:{min:1,max:10,label:"价格"},on:{change:e.handleChangePrice},model:{value:e.dynamicValidateForm.specs[0].price,callback:function(t){e.$set(e.dynamicValidateForm.specs[0],"price",t)},expression:"dynamicValidateForm.specs[0].price"}})],1)],1),a("el-form-item",{staticClass:"submit_box"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("dynamicValidateForm")}}},[e._v("确认添加食品")])],1)],1)],1)],1)],1)],1)],1)},o=[],l=(a("a4d3"),a("e01a"),a("a434"),a("b0c0"),a("d3b7"),a("96cf"),a("ade3")),r=a("bdaa"),s=a("5c96"),n={name:"addProduce",data:function(){return{form:{specs:"",packing_fee:1,price:20},dynamicValidateForm:Object(l["a"])({restaurant_id:this.$route.query.id,category_id:"",name:"",active:"",description:"",image_path:"",attributes:[],specs:[{specs:"默认",packing_fee:1,price:1}]},"description",""),addform:{name:"",description:""},sortData:{sort:""},attrOptions:[{value:"新",label:"新品"},{value:"招",label:"招牌"}],options:[],id:this.$route.query.id,imgBaseUrl:r["c"],specsRadio:"单规格",isSingle:!1,dialogTableVisible:!1,dialogFormVisible:!1,formLabelWidth:"80px"}},methods:{moreEnter:function(){this.form.specs?(this.dynamicValidateForm.specs.push(this.form),this.dialogFormVisible=!1,console.log(this.dynamicValidateForm.specs)):this.$notify({title:"提示",message:"请填写规格",duration:0})},handleDelete:function(e,t){console.log(e,t),this.dynamicValidateForm.specs.splice(e,1)},handleEdit:function(e,t){console.log(e,t)},single:function(e){this.isSingle=!1,console.log(e)},more:function(e){console.log(e),this.isSingle=!0},handleChangePacking_fee:function(e){console.log(e)},handleChangePrice:function(e){console.log(e)},handleAvatarSuccess:function(e,t){this.dynamicValidateForm.image_path=e.image_path,console.log(e)},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){return e?(console.log(t.dynamicValidateForm,t.id),t.dynamicValidateForm.category_id?void r["b"].postAddProduce(t.dynamicValidateForm).then((function(e){console.log(e),1===e.data.status?(t.$message.success("添加食品成功"),t.dynamicValidateForm=Object(l["a"])({restaurant_id:t.$route.query.id,category_id:"",name:"",active:"",description:"",image_path:"",attributes:[],specs:[{specs:"默认",packing_fee:1,price:1}]},"description",""),t.sortData={sort:""}):t.$message.error("添加食品失败")})).catch((function(e){console.log(e)})):(console.log(t.dynamicValidateForm.category_id),t.$message.error("请选择商品种类"),!1)):(console.log("error submit!!"),!1)}))},onSubmitAdd:function(e){var t=this,a={name:this.addform.name,description:this.addform.description,restaurant_id:this.id};this.$refs[e].validate((function(e){if(!e)return!1;try{r["b"].postAddGoodsSort(a).then((function(e){1===e.data.status?(t.$message.success("添加成功"),t.init()):t.$message.error("添加失败")})).catch((function(e){console.log(e)}))}catch(i){console.log(i)}}))},init:function(){var e,t;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!this.$route.query.id){a.next=8;break}return e=this.$route.query.id,a.next=5,regeneratorRuntime.awrap(r["b"].getProduceSort(e));case 5:t=a.sent,1===t.data.status&&(this.options=t.data.category_list),console.log(t);case 8:a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log(a.t0);case 13:case"end":return a.stop()}}),null,this,[[0,10]])},handle:function(e){this.dynamicValidateForm.category_id=e,console.log(e)}},created:function(){this.init()},beforeRouteEnter:function(e,t,a){var i=e.query;i.id?a():s["MessageBox"].confirm("请选择好商店再来添加商品","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then((function(){s["Message"].success({message:"前往商家列表"}),a("/manage/merchantList")})).catch((function(e){s["Message"].warning({message:"您取消了操作,请选择其他服务"}),a({path:t.path})}))}},c=n,d=(a("1136"),a("fca7"),a("548d"),a("2877")),m=Object(d["a"])(c,i,o,!1,null,"5814466a",null);t["default"]=m.exports},1136:function(e,t,a){"use strict";var i=a("5eaa"),o=a.n(i);o.a},1259:function(e,t,a){},"548d":function(e,t,a){"use strict";var i=a("b47c"),o=a.n(i);o.a},"5eaa":function(e,t,a){},a434:function(e,t,a){"use strict";var i=a("23e7"),o=a("23cb"),l=a("a691"),r=a("50c4"),s=a("7b0b"),n=a("65f0"),c=a("8418"),d=a("1dde"),m=Math.max,u=Math.min,p=9007199254740991,f="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d("splice")},{splice:function(e,t){var a,i,d,b,g,h,y=s(this),v=r(y.length),F=o(e,v),_=arguments.length;if(0===_?a=i=0:1===_?(a=0,i=v-F):(a=_-2,i=u(m(l(t),0),v-F)),v+a-i>p)throw TypeError(f);for(d=n(y,i),b=0;b<i;b++)g=F+b,g in y&&c(d,b,y[g]);if(d.length=i,a<i){for(b=F;b<v-i;b++)g=b+i,h=b+a,g in y?y[h]=y[g]:delete y[h];for(b=v;b>v-i+a;b--)delete y[b-1]}else if(a>i)for(b=v-i;b>F;b--)g=b+i-1,h=b+a-1,g in y?y[h]=y[g]:delete y[h];for(b=0;b<a;b++)y[b+F]=arguments[b+2];return y.length=v-i+a,d}})},b47c:function(e,t,a){},fca7:function(e,t,a){"use strict";var i=a("1259"),o=a.n(i);o.a}}]);
//# sourceMappingURL=chunk-ae6add56.8aeab453.js.map